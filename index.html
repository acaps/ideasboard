<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Josh.ai Ideas Board</title>
  <meta name="description" content="Submit ideas. Vote them up or down. See what rises to the top." />

  <!-- Lato for the page title font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#070A12;
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.66);
      --line:rgba(255,255,255,.12);
      --shadow: 0 14px 40px rgba(0,0,0,.45);
      --radius: 18px;
      --radius2: 14px;
      --max: 1200px;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --title: "Lato", var(--sans);

      --focus: rgba(125, 180, 255, .55);
      --focusRing: rgba(125,180,255,.12);

      --btnBg: rgba(255,255,255,.07);
      --btnBorder: rgba(255,255,255,.16);

      --btnPrimaryA: rgba(125,180,255,.28);
      --btnPrimaryB: rgba(125,180,255,.12);
      --btnPrimaryBorder: rgba(125,180,255,.35);
    }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(1200px 700px at 20% -10%, rgba(90,140,255,.22), transparent 60%),
        radial-gradient(900px 600px at 100% 0%, rgba(170,90,255,.18), transparent 55%),
        radial-gradient(900px 700px at 70% 120%, rgba(90,255,170,.12), transparent 55%),
        var(--bg);
      min-height:100vh;
    }

    .wrap{
      max-width: var(--max);
      margin: 0 auto;
      padding: 26px 16px 46px;
    }

    .topbar{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap: 14px;
      margin-bottom: 14px;
      flex-wrap:wrap;
    }

    .brand{
      display:flex;
      flex-direction:column;
      gap:8px;
      min-width: 260px;
      flex: 1 1 520px;
    }

    .title{
      font-family: var(--title);
      font-size: 30px;
      letter-spacing: .2px;
      margin:0;
      display:flex;
      align-items:center;
      gap:10px;
      font-weight: 900;
    }

    .pill{
      font-family: var(--mono);
      font-size: 12px;
      padding: 6px 10px;
      border: 1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius: 999px;
      color: var(--muted);
      width: fit-content;
    }

    .subtitle{
      margin:0;
      color: var(--muted);
      line-height: 1.35;
      max-width: 78ch;
    }

    .controlsRow{
      display:flex;
      gap: 10px;
      align-items:center;
      justify-content:flex-end;
      flex: 0 1 520px;
      margin-left:auto;
      flex-wrap:wrap;
    }

    button{
      border: 1px solid var(--btnBorder);
      background: var(--btnBg);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 14px;
      cursor:pointer;
      font-weight: 700;
      letter-spacing: .2px;
      font-family: var(--sans);
      white-space:nowrap;
    }

    button.primary{
      background: linear-gradient(180deg, var(--btnPrimaryA), var(--btnPrimaryB));
      border-color: var(--btnPrimaryBorder);
    }

    button:disabled{
      opacity: .55;
      cursor: not-allowed;
    }

    .seg{
      display:flex;
      align-items:center;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      border-radius: 14px;
      overflow:hidden;
      height: 42px;
    }
    .seg button{
      border: none;
      border-right: 1px solid rgba(255,255,255,.10);
      border-radius: 0;
      padding: 10px 12px;
      background: transparent;
      height: 42px;
    }
    .seg button:last-child{ border-right:none; }
    .seg button.active{
      background: rgba(255,255,255,.08);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.08);
    }

    .searchWrap{
      display:flex;
      align-items:center;
      gap: 8px;
      height: 42px;
      padding: 0 10px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      min-width: min(420px, 100%);
      flex: 1 1 320px;
    }
    .searchIcon{
      font-family: var(--mono);
      color: var(--muted);
      font-size: 12px;
      user-select:none;
    }
    .searchWrap input{
      width: 100%;
      border: none;
      outline: none;
      background: transparent;
      color: var(--text);
      font-size: 14px;
      padding: 0;
      height: 40px;
    }
    .searchWrap input::placeholder{ color: rgba(255,255,255,.45); }
    .clearX{
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      border-radius: 12px;
      width: 32px;
      height: 32px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      user-select:none;
      color: rgba(255,255,255,.78);
      font-family: var(--mono);
      font-size: 12px;
    }
    .clearX:hover{
      box-shadow: 0 0 0 4px rgba(255,255,255,.06);
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.045));
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .cardHeader{
      padding: 14px 16px 12px;
      border-bottom: 1px solid var(--line);
      background: rgba(255,255,255,.03);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
      flex-wrap:wrap;
    }

    .cardHeader h2{
      margin:0;
      font-size: 14px;
      letter-spacing:.3px;
      color: var(--muted);
      font-family: var(--mono);
      text-transform: uppercase;
    }

    .listMeta{
      font-size: 13px;
      color: var(--muted);
      font-family: var(--mono);
      white-space:nowrap;
    }

    .ideas{
      padding: 10px;
      display:flex;
      flex-direction:column;
      gap: 10px;
    }

    .idea{
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      border-radius: var(--radius2);
      padding: 12px;
      display:flex;
      gap: 12px;
      align-items:flex-start;
    }

    .voteCol{
      display:flex;
      flex-direction:column;
      gap: 8px;
      min-width: 96px;
      align-items:center;
      padding: 8px 8px;
      border-radius: 14px;
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.10);
      flex: 0 0 auto;
    }

    .score{
      font-family: var(--mono);
      font-size: 18px;
      letter-spacing: .4px;
      text-align:center;
    }

    .score small{
      display:block;
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
      text-align:center;
    }

    .voteBtns{
      display:flex;
      gap: 8px;
    }

    .voteBtn{
      width: 34px;
      height: 34px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 16px;
      user-select:none;
    }

    .voteBtn.up:hover{
      border-color: rgba(90,255,170,.5);
      box-shadow: 0 0 0 4px rgba(90,255,170,.12);
    }

    .voteBtn.down:hover{
      border-color: rgba(255,120,120,.5);
      box-shadow: 0 0 0 4px rgba(255,120,120,.10);
    }

    .voteBtn.disabled{
      opacity: .45;
      cursor:not-allowed;
    }

    .voteBtn.disabled:hover{
      box-shadow:none;
    }

    .ideaMain{
      flex:1;
      display:flex;
      flex-direction:column;
      gap: 6px;
      padding-top: 2px;
      min-width: 0;
    }

    .ideaTitle{
      margin:0;
      font-size: 16px;
      letter-spacing: .15px;
      line-height: 1.25;
      word-break: break-word;
    }

    .ideaDesc{
      margin:0;
      color: rgba(255,255,255,.74);
      line-height: 1.35;
      font-size: 14px;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .ideaFoot{
      display:flex;
      gap: 10px;
      align-items:center;
      margin-top: 6px;
      color: var(--muted);
      font-size: 12px;
      font-family: var(--mono);
      flex-wrap:wrap;
    }

    .pager{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
      padding: 12px 16px 16px;
      border-top: 1px solid var(--line);
      background: rgba(255,255,255,.02);
    }

    .pager .pageInfo{
      color: var(--muted);
      font-family: var(--mono);
      font-size: 12px;
    }

    .toast{
      position: fixed;
      left: 50%;
      bottom: 22px;
      transform: translateX(-50%);
      background: rgba(0,0,0,.65);
      border: 1px solid rgba(255,255,255,.14);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 999px;
      box-shadow: var(--shadow);
      opacity: 0;
      pointer-events: none;
      transition: opacity .18s ease;
      max-width: min(720px, calc(100vw - 24px));
      text-align:center;
      font-size: 13px;
      z-index: 50;
    }
    .toast.show{ opacity: 1; }

    /* Modal */
    .modalOverlay{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.62);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 16px;
      z-index: 100;
    }
    .modalOverlay.open{ display:flex; }

    .modal{
      width: min(720px, 100%);
      border-radius: 22px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      box-shadow: 0 18px 60px rgba(0,0,0,.55);
    }
    .modalHead{
      padding: 14px 16px;
      border-bottom: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
    }
    .modalHead h3{
      margin:0;
      font-family: var(--mono);
      text-transform: uppercase;
      letter-spacing:.3px;
      font-size: 13px;
      color: var(--muted);
    }
    .modalBody{ padding: 16px; }

    label{
      display:block;
      font-size: 13px;
      color: var(--muted);
      margin: 10px 0 8px;
    }

    input, textarea{
      width:100%;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: var(--text);
      padding: 12px 12px;
      outline: none;
      font-size: 14px;
      font-family: var(--sans);
    }
    textarea{ min-height: 140px; resize: vertical; }

    input:focus, textarea:focus{
      border-color: var(--focus);
      box-shadow: 0 0 0 4px var(--focusRing);
    }

    .modalActions{
      display:flex;
      gap: 10px;
      align-items:center;
      margin-top: 12px;
      justify-content:flex-end;
      flex-wrap:wrap;
    }

    .hint{
      margin: 10px 0 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
    }

    /* Mobile tweaks */
    @media (max-width: 720px){
      .controlsRow{ justify-content:flex-start; }
    }
    @media (max-width: 560px){
      .title{ font-size: 26px; }
      .voteCol{ min-width: 86px; }
      .idea{ padding: 10px; }
      .wrap{ padding: 22px 14px 42px; }
      .searchWrap{ min-width: 100%; }
      .seg{ width: 100%; }
      .seg button{ width: 50%; }
      .controlsRow{ width: 100%; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <h1 class="title">Josh.ai Ideas Board</h1>
        <div class="pill">Submit • Vote • Sort by signal</div>
        <p class="subtitle">
          Static demo (no backend). Ideas and votes are stored in your browser. Each idea can be voted once per browser.
        </p>
      </div>

      <div class="controlsRow">
        <div class="seg" aria-label="Sort toggle">
          <button id="toggleTop" class="active" type="button">Top</button>
          <button id="toggleNew" type="button">New</button>
        </div>

        <div class="searchWrap">
          <span class="searchIcon">Search</span>
          <input id="searchInput" type="search" placeholder="Title, description, or name" />
          <div id="clearSearch" class="clearX" title="Clear">×</div>
        </div>

        <button class="primary" id="openSubmit" type="button">Submit Idea</button>
      </div>
    </div>

    <section class="card">
      <div class="cardHeader">
        <h2 id="listHeading">Top ideas</h2>
        <div class="listMeta" id="listMeta">Loading…</div>
      </div>

      <div class="ideas" id="ideas"></div>

      <div class="pager">
        <button id="prevBtn" type="button">Prev</button>
        <div class="pageInfo" id="pageInfo">Page 1</div>
        <button id="nextBtn" type="button">Next</button>
      </div>
    </section>
  </div>

  <!-- Modal -->
  <div class="modalOverlay" id="modalOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="submitTitle">
      <div class="modalHead">
        <h3 id="submitTitle">Submit an idea</h3>
        <button id="closeSubmit" type="button" title="Close">Close</button>
      </div>
      <div class="modalBody">
        <label for="name">Name</label>
        <input id="name" maxlength="60" placeholder="Your name" />

        <label for="title">Title</label>
        <input id="title" maxlength="120" placeholder="A short, specific idea title" />

        <label for="desc">Description</label>
        <textarea id="desc" maxlength="2000" placeholder="Explain the idea in a couple sentences..."></textarea>

        <div class="modalActions">
          <button id="cancelBtn" type="button">Cancel</button>
          <button class="primary" id="submitBtn" type="button">Submit</button>
        </div>

        <p class="hint">
          This is a UI-only prototype. If you open the page in a different browser/device, it will look empty.
        </p>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

<script>
  const STORAGE_KEY = "josh_ideas_demo_v3";
  const VOTES_KEY = "josh_ideas_votes_v3";
  const PAGE_SIZE = 20;

  const state = {
    page: 1,
    totalPages: 1,
    total: 0,
    ideas: [],
    sortMode: "top",   // "top" | "new"
    query: ""          // search query
  };

  const elIdeas = document.getElementById("ideas");
  const elListMeta = document.getElementById("listMeta");
  const elPageInfo = document.getElementById("pageInfo");
  const elPrev = document.getElementById("prevBtn");
  const elNext = document.getElementById("nextBtn");
  const elToast = document.getElementById("toast");
  const elHeading = document.getElementById("listHeading");

  const overlay = document.getElementById("modalOverlay");
  const btnOpen = document.getElementById("openSubmit");
  const btnClose = document.getElementById("closeSubmit");
  const btnCancel = document.getElementById("cancelBtn");
  const btnSubmit = document.getElementById("submitBtn");

  const elName = document.getElementById("name");
  const elTitle = document.getElementById("title");
  const elDesc = document.getElementById("desc");

  const btnTop = document.getElementById("toggleTop");
  const btnNew = document.getElementById("toggleNew");

  const elSearch = document.getElementById("searchInput");
  const elClearSearch = document.getElementById("clearSearch");

  function showToast(msg) {
    elToast.textContent = msg;
    elToast.classList.add("show");
    setTimeout(() => elToast.classList.remove("show"), 2200);
  }

  function fmtDate(ms) {
    const d = new Date(ms);
    return d.toLocaleDateString(undefined, { year: "numeric", month: "short", day: "2-digit" });
  }

  function loadAllIdeas() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      const ideas = raw ? JSON.parse(raw) : [];
      return Array.isArray(ideas) ? ideas : [];
    } catch {
      return [];
    }
  }

  function saveAllIdeas(ideas) {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(ideas));
  }

  function loadVotesMap() {
    try {
      const raw = localStorage.getItem(VOTES_KEY);
      const map = raw ? JSON.parse(raw) : {};
      return map && typeof map === "object" ? map : {};
    } catch {
      return {};
    }
  }

  function saveVotesMap(map) {
    localStorage.setItem(VOTES_KEY, JSON.stringify(map));
  }

  function normalize(s) {
    return String(s || "").toLowerCase().trim();
  }

  function filterIdeas(ideas, query) {
    const q = normalize(query);
    if (!q) return ideas;

    return ideas.filter(i => {
      const blob = normalize([i.title, i.description, i.name].join(" "));
      return blob.includes(q);
    });
  }

  function sortIdeas(ideas) {
    const arr = [...ideas];
    if (state.sortMode === "new") {
      // newest first
      arr.sort((a,b) => (b.created_at - a.created_at) || (b.score - a.score));
      return arr;
    }
    // top: score desc, then created_at desc
    arr.sort((a,b) => (b.score - a.score) || (b.created_at - a.created_at));
    return arr;
  }

  function paginate(ideas, page) {
    const total = ideas.length;
    const totalPages = Math.max(1, Math.ceil(total / PAGE_SIZE));
    const p = Math.min(Math.max(1, page), totalPages);
    const start = (p - 1) * PAGE_SIZE;
    return { page: p, total, totalPages, ideas: ideas.slice(start, start + PAGE_SIZE) };
  }

  function refresh(page = state.page) {
    const all = loadAllIdeas();
    const filtered = filterIdeas(all, state.query);
    const sorted = sortIdeas(filtered);
    const paged = paginate(sorted, page);

    state.page = paged.page;
    state.total = paged.total;
    state.totalPages = paged.totalPages;
    state.ideas = paged.ideas;

    render();
  }

  function render() {
    elIdeas.innerHTML = "";

    elHeading.textContent = state.sortMode === "new" ? "New ideas" : "Top ideas";

    const q = state.query.trim();
    if (q) {
      elListMeta.textContent = `${state.total} result${state.total === 1 ? "" : "s"} • filtered by “${q}”`;
    } else {
      elListMeta.textContent = `${state.total} idea${state.total === 1 ? "" : "s"} • ${state.sortMode === "new" ? "Newest first" : "Sorted by score"}`;
    }

    elPageInfo.textContent = `Page ${state.page} of ${state.totalPages}`;

    elPrev.disabled = state.page <= 1;
    elNext.disabled = state.page >= state.totalPages;

    const votesMap = loadVotesMap();

    if (!state.ideas.length) {
      const empty = document.createElement("div");
      empty.className = "idea";
      empty.innerHTML = `
        <div class="ideaMain">
          <h3 class="ideaTitle">${q ? "No matches" : "No ideas yet"}</h3>
          <p class="ideaDesc">${q ? "Try a different search." : "Tap “Submit Idea” to add the first one."}</p>
        </div>
      `;
      elIdeas.appendChild(empty);
      return;
    }

    for (const idea of state.ideas) {
      const row = document.createElement("div");
      row.className = "idea";

      const votesLine = `${idea.upvotes} up • ${idea.downvotes} down`;
      const hasVoted = !!votesMap[String(idea.id)];

      row.innerHTML = `
        <div class="voteCol">
          <div class="score">${idea.score}<small>${votesLine}</small></div>
          <div class="voteBtns">
            <div class="voteBtn up ${hasVoted ? "disabled" : ""}" title="Upvote" role="button" aria-label="Upvote">▲</div>
            <div class="voteBtn down ${hasVoted ? "disabled" : ""}" title="Downvote" role="button" aria-label="Downvote">▼</div>
          </div>
        </div>
        <div class="ideaMain">
          <h3 class="ideaTitle"></h3>
          <p class="ideaDesc"></p>
          <div class="ideaFoot">
            <span>#${idea.id}</span>
            <span>•</span>
            <span>${fmtDate(idea.created_at)}</span>
            <span>•</span>
            <span>Submitted by ${escapeHtml(idea.name || "Anonymous")}</span>
            ${hasVoted ? `<span>•</span><span>voted</span>` : ``}
          </div>
        </div>
      `;

      row.querySelector(".ideaTitle").textContent = idea.title;
      row.querySelector(".ideaDesc").textContent = idea.description;

      const upBtn = row.querySelector(".voteBtn.up");
      const downBtn = row.querySelector(".voteBtn.down");

      upBtn.addEventListener("click", () => { if (!hasVoted) vote(idea.id, 1); });
      downBtn.addEventListener("click", () => { if (!hasVoted) vote(idea.id, -1); });

      elIdeas.appendChild(row);
    }
  }

  function nextIdeaId(ideas) {
    let max = 0;
    for (const i of ideas) max = Math.max(max, i.id || 0);
    return max + 1;
  }

  function submitIdea() {
    const name = elName.value.trim();
    const title = elTitle.value.trim();
    const description = elDesc.value.trim();

    if (name.length < 2 || name.length > 60) return showToast("Name must be 2–60 characters.");
    if (title.length < 3 || title.length > 120) return showToast("Title must be 3–120 characters.");
    if (description.length < 10 || description.length > 2000) return showToast("Description must be 10–2000 characters.");

    const ideas = loadAllIdeas();
    const id = nextIdeaId(ideas);

    ideas.push({
      id,
      name,
      title,
      description,
      score: 0,
      upvotes: 0,
      downvotes: 0,
      created_at: Date.now()
    });

    saveAllIdeas(ideas);

    elName.value = "";
    elTitle.value = "";
    elDesc.value = "";

    closeModal();
    showToast("Idea submitted.");

    // If user is in "New" mode, the new idea will appear at the top; go to page 1 either way.
    refresh(1);
  }

  function vote(ideaId, value) {
    const votesMap = loadVotesMap();
    const key = String(ideaId);

    if (votesMap[key]) {
      showToast("You already voted on this idea.");
      return;
    }

    const ideas = loadAllIdeas();
    const idx = ideas.findIndex(i => i.id === ideaId);
    if (idx === -1) return showToast("Idea not found.");

    if (value === 1) {
      ideas[idx].score += 1;
      ideas[idx].upvotes += 1;
    } else {
      ideas[idx].score -= 1;
      ideas[idx].downvotes += 1;
    }

    votesMap[key] = value;
    saveVotesMap(votesMap);
    saveAllIdeas(ideas);

    showToast(value === 1 ? "Upvoted." : "Downvoted.");

    // Refresh current page; sorting/filtering may move the item
    refresh(state.page);
  }

  // Minimal escaping for the one spot we inject HTML (footer string)
  function escapeHtml(str) {
    return String(str)
      .replaceAll("&", "&amp;")
      .replaceAll("<", "&lt;")
      .replaceAll(">", "&gt;")
      .replaceAll('"', "&quot;")
      .replaceAll("'", "&#039;");
  }

  function openModal() {
    overlay.classList.add("open");
    overlay.setAttribute("aria-hidden", "false");
    setTimeout(() => elName.focus(), 0);
  }

  function closeModal() {
    overlay.classList.remove("open");
    overlay.setAttribute("aria-hidden", "true");
  }

  // Toggle handlers
  function setSortMode(mode) {
    state.sortMode = mode;
    btnTop.classList.toggle("active", mode === "top");
    btnNew.classList.toggle("active", mode === "new");
    refresh(1);
  }

  btnTop.addEventListener("click", () => setSortMode("top"));
  btnNew.addEventListener("click", () => setSortMode("new"));

  // Search handlers
  function setQuery(q) {
    state.query = q;
    refresh(1);
  }

  let searchTimer = null;
  elSearch.addEventListener("input", () => {
    const v = elSearch.value;
    // tiny debounce to keep it snappy without rerendering every keystroke on huge lists
    clearTimeout(searchTimer);
    searchTimer = setTimeout(() => setQuery(v), 120);
  });

  elClearSearch.addEventListener("click", () => {
    elSearch.value = "";
    setQuery("");
    elSearch.focus();
  });

  // Modal handlers
  btnOpen.addEventListener("click", openModal);
  btnClose.addEventListener("click", closeModal);
  btnCancel.addEventListener("click", closeModal);

  overlay.addEventListener("click", (e) => {
    if (e.target === overlay) closeModal();
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && overlay.classList.contains("open")) closeModal();
  });

  btnSubmit.addEventListener("click", submitIdea);

  // Pager
  elPrev.addEventListener("click", () => refresh(state.page - 1));
  elNext.addEventListener("click", () => refresh(state.page + 1));

  // Seed with your requested examples (once)
  (function seedIfEmpty(){
    const ideas = loadAllIdeas();
    if (ideas.length) return;

    const now = Date.now();

    const seeded = [
      {
        id: 1,
        name: "Alex",
        title: "Let me use my personal ChatGPT account inside Josh",
        description:
          "I want the option to connect my own ChatGPT account so Josh can use my existing preferences, custom instructions, and history. This should be opt-in, clearly separated from Josh.ai defaults, and easy to disconnect at any time.",
        score: 9,
        upvotes: 9,
        downvotes: 0,
        created_at: now - (3 * 86400000)
      },
      {
        id: 2,
        name: "Brian",
        title: "Integrate with NVIDIA Shield for faster, cleaner media control",
        description:
          "Add native integration for NVIDIA Shield so users can launch apps, control playback, and manage inputs reliably. Ideally this includes fast wake, better state awareness, and smoother voice control for common streaming workflows.",
        score: 5,
        upvotes: 5,
        downvotes: 0,
        created_at: now - (2 * 86400000)
      },
      {
        id: 3,
        name: "Maria",
        title: "Josh should speak Spanish (and switch languages naturally)",
        description:
          "Enable Spanish voice responses and understanding, with a simple setting to choose language per user or per room. Bonus if Josh can detect Spanish vs English and respond in the same language without extra commands.",
        score: 2,
        upvotes: 2,
        downvotes: 0,
        created_at: now - (1 * 86400000)
      },
      {
        id: 4,
        name: "Chris",
        title: "Add folders for Scenes so we can organize by room or use-case",
        description:
          "As scene libraries grow, it gets hard to find the right one quickly. Add folders (or tags) so I can group scenes by room, time-of-day, or purpose like ‘Entertaining’, ‘Morning’, or ‘Kids’.",
        score: 0,
        upvotes: 0,
        downvotes: 0,
        created_at: now
      }
    ];

    saveAllIdeas(seeded);
  })();

  // Start
  setSortMode("top");
  refresh(1);
</script>
</body>
</html>